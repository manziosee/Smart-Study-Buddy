{% extends 'base/base.html' %}

{% block title %}Dashboard - Smart Study Buddy{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Welcome Section -->
    <div class="relative bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-800 dark:to-purple-800 rounded-2xl p-8 text-white shadow-2xl animate-fade-in overflow-hidden" data-aos="fade-down">
        <!-- Animated background particles -->
        <div class="absolute inset-0 opacity-20">
            <div class="absolute top-4 right-8 w-16 h-16 bg-white rounded-full animate-float"></div>
            <div class="absolute bottom-4 left-8 w-12 h-12 bg-yellow-300 rounded-full animate-float-delayed"></div>
            <div class="absolute top-1/2 right-1/4 w-8 h-8 bg-pink-300 rounded-full animate-bounce-slow"></div>
        </div>
        
        <div class="relative z-10 flex items-center justify-between">
            <div>
                <h1 class="text-4xl font-bold mb-2">
                    <span class="gradient-text" data-typewriter data-speed="80">Welcome back, {{ user.username }}!</span> 
                    <span class="animate-bounce-slow ml-2">ðŸ§ </span>
                </h1>
                <p class="text-blue-100 text-lg animate-fade-in" style="animation-delay: 1s;">Ready to supercharge your learning with AI?</p>
            </div>
            <div class="hidden md:block">
                <div class="magnetic w-24 h-24 glass-effect rounded-full flex items-center justify-center animate-pulse-glow hover-lift">
                    <i class="fas fa-graduation-cap text-3xl text-white"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border dark:border-gray-700" data-aos="fade-up" data-aos-delay="100">
            <div class="flex items-center mb-4">
                <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-upload text-xl text-white"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Upload Document</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Upload PDF, TXT, or MD files to extract and summarize content.</p>
            <a href="{% url 'upload_file' %}" class="magnetic bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-3 rounded-lg hover:from-green-700 hover:to-emerald-700 inline-block transition-all duration-200 transform hover:scale-105 shadow-lg animate-glow">
                <i class="fas fa-plus mr-2"></i>Upload File
            </a>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border dark:border-gray-700" data-aos="fade-up" data-aos-delay="200">
            <div class="flex items-center mb-4">
                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-edit text-xl text-white"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Create Note</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Write your own notes and generate AI summaries.</p>
            <a href="{% url 'create_note' %}" class="magnetic bg-gradient-to-r from-blue-600 to-cyan-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-cyan-700 inline-block transition-all duration-200 transform hover:scale-105 shadow-lg animate-glow">
                <i class="fas fa-plus mr-2"></i>New Note
            </a>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border dark:border-gray-700" data-aos="fade-up" data-aos-delay="300">
            <div class="flex items-center mb-4">
                <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-question-circle text-xl text-white"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Generate Quiz</h3>
            </div>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Create interactive quizzes from your notes.</p>
            <a href="{% url 'notes_list' %}" class="magnetic bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-lg hover:from-purple-700 hover:to-pink-700 inline-block transition-all duration-200 transform hover:scale-105 shadow-lg animate-glow">
                <i class="fas fa-brain mr-2"></i>Make Quiz
            </a>
        </div>
    </div>

    <!-- Stats Overview -->
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-300 transform hover:scale-105 border dark:border-gray-700" data-aos="zoom-in" data-aos-delay="100">
            <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-file-alt text-2xl text-white"></i>
            </div>
            <div class="text-3xl font-bold text-gray-800 dark:text-white mb-2 counter" data-target="{{ stats.notes_count }}">0</div>
            <div class="text-gray-600 dark:text-gray-400 font-medium">Notes</div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-300 transform hover:scale-105 border dark:border-gray-700" data-aos="zoom-in" data-aos-delay="200">
            <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-magic text-2xl text-white"></i>
            </div>
            <div class="text-3xl font-bold text-gray-800 dark:text-white mb-2 counter" data-target="{{ stats.summaries_count }}">0</div>
            <div class="text-gray-600 dark:text-gray-400 font-medium">Summaries</div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-300 transform hover:scale-105 border dark:border-gray-700" data-aos="zoom-in" data-aos-delay="300">
            <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-question-circle text-2xl text-white"></i>
            </div>
            <div class="text-3xl font-bold text-gray-800 dark:text-white mb-2 counter" data-target="{{ stats.quizzes_count }}">0</div>
            <div class="text-gray-600 dark:text-gray-400 font-medium">Quizzes</div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center hover:shadow-2xl transition-all duration-300 transform hover:scale-105 border dark:border-gray-700" data-aos="zoom-in" data-aos-delay="400">
            <div class="w-16 h-16 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-trophy text-2xl text-white"></i>
            </div>
            <div class="text-3xl font-bold text-gray-800 dark:text-white mb-2 counter" data-target="{{ stats.quiz_attempts }}">0</div>
            <div class="text-gray-600 dark:text-gray-400 font-medium">Quiz Attempts</div>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Recent Notes -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 sm:p-6 border dark:border-gray-700 hover-lift" data-aos="fade-up" data-aos-delay="100">
        <!-- Recent Notes -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fas fa-file-alt text-blue-600 mr-2"></i>Recent Notes
            </h3>
            {% if recent_notes %}
                <div class="space-y-3">
                    {% for note in recent_notes %}
                        <div class="border-l-4 border-blue-500 pl-4 py-2">
                            <h4 class="font-medium">{{ note.title }}</h4>
                            <p class="text-sm text-gray-600">{{ note.created_at|date:"M d, Y" }}</p>
                            <div class="mt-2 space-x-2">
                                <a href="{% url 'note_detail' note.id %}" class="text-blue-600 hover:underline text-sm">View</a>
                                {% if not note.summary %}
                                    <a href="{% url 'summarize_note' note.id %}" class="text-green-600 hover:underline text-sm">Summarize</a>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="text-gray-500">No notes yet. <a href="{% url 'create_note' %}" class="text-blue-600 hover:underline">Create your first note!</a></p>
            {% endif %}
        </div>

        <!-- Recent Quizzes -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fas fa-question-circle text-purple-600 mr-2"></i>Recent Quizzes
            </h3>
            {% if recent_quizzes %}
                <div class="space-y-3">
                    {% for quiz in recent_quizzes %}
                        <div class="border-l-4 border-purple-500 pl-4 py-2">
                            <h4 class="font-medium">{{ quiz.title }}</h4>
                            <p class="text-sm text-gray-600">{{ quiz.created_at|date:"M d, Y" }}</p>
                            <div class="mt-2">
                                <a href="{% url 'quiz_detail' quiz.id %}" class="text-purple-600 hover:underline text-sm">Take Quiz</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="text-gray-500">No quizzes yet. <a href="{% url 'notes_list' %}" class="text-purple-600 hover:underline">Generate from your notes!</a></p>
            {% endif %}
        </div>
    </div>
</div>

<script>
// Counter animation for stats
document.addEventListener('DOMContentLoaded', function() {
    const counters = document.querySelectorAll('.counter');
    
    const animateCounter = (counter) => {
        const target = parseInt(counter.getAttribute('data-target'));
        const increment = target / 50;
        let current = 0;
        
        const updateCounter = () => {
            if (current < target) {
                current += increment;
                counter.textContent = Math.ceil(current);
                setTimeout(updateCounter, 30);
            } else {
                counter.textContent = target;
            }
        };
        
        updateCounter();
    };
    
    // Intersection Observer for counter animation
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                animateCounter(entry.target);
                observer.unobserve(entry.target);
            }
        });
    });
    
    counters.forEach(counter => {
        observer.observe(counter);
    });
});
</script>
{% endblock %}